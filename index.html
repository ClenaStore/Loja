<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Clena Foods â€¢ CatÃ¡logo</title>
  <style>
    :root{
      --bg:#0e0f12; --panel:#14161a; --line:#262b36;
      --brand:#e63946; --brand-2:#ff8f1f;
      --txt:#f7f8fa; --muted:#cbd5e1;
      --shadow:0 12px 28px rgba(0,0,0,.35),0 2px 8px rgba(0,0,0,.25);
    }
    body{margin:0;background:var(--bg);color:var(--txt);font-family:Inter,system-ui,sans-serif;}
    header{padding:14px;border-bottom:1px solid var(--line);
      background:linear-gradient(180deg,#1a1f27,#14181f);
      font-weight:800;display:flex;align-items:center;gap:10px}
    header img{width:34px;height:34px;border-radius:8px;box-shadow:var(--shadow)}
    header h1{font-size:16px;margin:0}
    .page{padding:16px;display:grid;gap:12px;grid-template-columns:1fr}
    @media(min-width:600px){.page{grid-template-columns:1fr 1fr}}
    @media(min-width:900px){.page{grid-template-columns:1fr 1fr 1fr}}
    .card{background:linear-gradient(180deg,#151921,#12161c);
      border:1px solid var(--line);border-radius:14px;overflow:hidden;
      box-shadow:var(--shadow);display:flex;flex-direction:column}
    .card img{width:100%;height:140px;object-fit:cover}
    .card .body{padding:10px;display:flex;flex-direction:column;gap:6px;flex:1}
    .card .name{font-weight:700}
    .card .price{color:#fcd34d;font-weight:700}
    .btn{appearance:none;border:0;padding:10px;border-radius:10px;
      background:linear-gradient(180deg,var(--brand-2),var(--brand));color:#fff;
      font-weight:700;cursor:pointer;text-align:center}
    .btn.small{padding:6px 10px;font-size:13px}
    .btn.secondary{background:linear-gradient(180deg,#2b3240,#1c222c)}
    #cartDrawer{position:fixed;top:0;right:0;bottom:0;width:90vw;max-width:380px;
      background:linear-gradient(180deg,#161a22,#12161c);
      border-left:1px solid var(--line);transform:translateX(100%);
      transition:.28s ease;box-shadow:var(--shadow);display:flex;flex-direction:column;z-index:50}
    #cartDrawer.open{transform:translateX(0)}
    .drawerHead{padding:12px;font-weight:800;border-bottom:1px solid var(--line);display:flex;justify-content:space-between;align-items:center}
    .drawerBody{flex:1;overflow:auto;padding:12px;display:grid;gap:8px}
    .drawerFoot{padding:12px;border-top:1px solid var(--line);display:grid;gap:8px}
    .row{display:flex;justify-content:space-between;align-items:center;font-size:14px}
    .qty{display:flex;gap:6px;align-items:center}
    .qty button{width:28px;height:28px;border-radius:8px;background:#0f1115;
      border:1px solid var(--line);color:var(--txt);cursor:pointer}
  </style>
</head>
<body>
  <header>
    <img src="https://github.com/ClenaStore/foods/blob/main/paste/ChatGPT%20Image%2027%20de%20ago.%20de%202025,%2019_35_02.png?raw=true" alt="logo">
    <h1>CLENA FOODS</h1>
    <button class="btn small secondary" style="margin-left:auto" onclick="toggleCart(true)">ðŸ›’ Carrinho (<span id="cartBadge">0</span>)</button>
  </header>

  <main class="page" id="menuGrid"></main>

  <aside id="cartDrawer">
    <div class="drawerHead">
      <span>Meu Carrinho</span>
      <button class="btn small secondary" onclick="toggleCart(false)">Fechar âœ–</button>
    </div>
    <div class="drawerBody" id="cartItems"></div>
    <div class="drawerFoot">
      <div class="row"><span>Total:</span><strong id="grandTotal">R$ 0,00</strong></div>
      <button class="btn">Finalizar Pedido</button>
    </div>
  </aside>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbwbOlm3qbzOa89xKn9-MBQOnATbYOYGBJS-xMo2ppDEzWlX3qtvLzadysBdvo5o7dui/exec";

    let menu = [];
    let cart = [];

    const $=s=>document.querySelector(s);
    const BRL=v=>v.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});

    async function loadMenu(){
      try{
        const res = await fetch(API_URL,{method:"POST",body:JSON.stringify({acao:"getMenu"})});
        const data = await res.json();
        if(data.ok) menu = data.items || [];
        renderMenu();
      }catch(e){
        console.error("Erro ao carregar menu:",e);
      }
    }

    function renderMenu(){
      const grid=$("#menuGrid"); grid.innerHTML="";
      menu.forEach(i=>{
        const el=document.createElement("div"); el.className="card";
        el.innerHTML=`
          <img src="${i.img}" alt="${i.name}">
          <div class="body">
            <div class="name">${i.name}</div>
            <div class="price">${BRL(i.price)}</div>
            <button class="btn" onclick="addToCart(${i.id})">Adicionar</button>
          </div>`;
        grid.appendChild(el);
      });
    }

    function renderCart(){
      $("#cartBadge").textContent=cart.reduce((a,b)=>a+b.qty,0);
      const box=$("#cartItems"); box.innerHTML="";
      let total=0;
      cart.forEach((it,ix)=>{
        const t=it.qty*it.price; total+=t;
        const row=document.createElement("div"); row.className="row";
        row.innerHTML=`
          <span>${it.qty}Ã— ${it.name}</span>
          <div class="qty">
            <button onclick="dec(${ix})">-</button>
            <button onclick="inc(${ix})">+</button>
          </div>
          <strong>${BRL(t)}</strong>`;
        box.appendChild(row);
      });
      $("#grandTotal").textContent=BRL(total);
    }

    function addToCart(id){
      const p=menu.find(x=>String(x.id)===String(id));
      if(!p) return;
      const f=cart.find(x=>x.id===p.id);
      if(f) f.qty++; else cart.push({...p,qty:1});
      renderCart();
      toggleCart(true);
    }
    function inc(ix){cart[ix].qty++; renderCart()}
    function dec(ix){ if(cart[ix].qty>1) cart[ix].qty--; else cart.splice(ix,1); renderCart() }
    function toggleCart(open){ $("#cartDrawer").classList.toggle("open",open) }

    loadMenu();
  </script>
</body>
</html>
