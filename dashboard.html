<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Dashboard ‚Ä¢ AgendaBeauty</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
  --primary:#ff6a00;
  --dark1:#061a2e;
  --dark2:#0b2a4a;
  --text:#e5e7eb;
  --muted:#9ca3af;
}

*{
  box-sizing:border-box;
  font-family:Inter,sans-serif;
}

body{
  margin:0;
  height:100vh;
  display:flex;
  background:#f4f6f9;
  zoom:0.9; /* üîç DIMINUI O ZOOM GERAL */
}

/* ===== SIDEBAR ===== */
.sidebar{
  width:250px;
  background:linear-gradient(180deg,var(--dark1),var(--dark2));
  color:white;
  transition:.3s;
  display:flex;
  flex-direction:column;
}
.sidebar.collapsed{
  width:72px;
}

/* LOGO */
.logo{
  padding:18px 20px;
  font-weight:700;
  font-size:18px;
  color:var(--primary);
  white-space:nowrap;
}
.sidebar.collapsed .logo span{
  display:none;
}

/* MENU */
.menu{
  flex:1;
  padding-top:10px;
}

.item{
  cursor:pointer;
  padding:12px 18px;
  display:flex;
  align-items:center;
  gap:14px;
  color:var(--text);
  transition:.2s;
}
.item:hover{
  background:rgba(255,255,255,.06);
}
.item.active{
  background:rgba(255,106,0,.18);
}

.icon{
  width:22px;
  text-align:center;
  font-size:18px;
}
.label{
  white-space:nowrap;
}
.sidebar.collapsed .label{
  display:none;
}

/* SUBMENU */
.submenu{
  display:none;
  flex-direction:column;
  padding-left:52px;
}
.submenu .subitem{
  padding:8px 0;
  font-size:14px;
  color:var(--muted);
  cursor:pointer;
}
.submenu .subitem:hover{
  color:white;
}

/* FOOTER */
.sidebar-footer{
  padding:16px 18px;
  border-top:1px solid rgba(255,255,255,.08);
}
.logout{
  display:flex;
  align-items:center;
  gap:14px;
  cursor:pointer;
  color:#fca5a5;
}
.sidebar.collapsed .logout span{
  display:none;
}

/* ===== MAIN ===== */
.main{
  flex:1;
  display:flex;
  flex-direction:column;
}

/* TOPBAR */
.topbar{
  height:56px;
  background:white;
  display:flex;
  align-items:center;
  padding:0 20px;
  justify-content:space-between;
  border-bottom:1px solid #e5e7eb;
}

.toggle{
  font-size:22px;
  cursor:pointer;
}

.user{
  font-weight:600;
}

/* CONTENT */
.content{
  flex:1;
}
iframe{
  width:100%;
  height:100%;
  border:none;
}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
  <div class="logo">Agenda<span>Beauty</span></div>

  <div class="menu">

    <div class="item active" onclick="loadPage('home.html',this)">
      <div class="icon">üè†</div>
      <div class="label">Home</div>
    </div>

    <div class="item" onclick="toggleSub(this)">
      <div class="icon">üìÖ</div>
      <div class="label">Agenda</div>
    </div>
    <div class="submenu">
      <div class="subitem" onclick="loadAndClose('agenda.html')">Minha agenda</div>
      <div class="subitem" onclick="loadAndClose('horarios.html')">Hor√°rios</div>
    </div>

    <div class="item" onclick="loadPage('clientes.html',this)">
      <div class="icon">üë•</div>
      <div class="label">Clientes</div>
    </div>

    <div class="item" onclick="toggleSub(this)">
      <div class="icon">üí∞</div>
      <div class="label">Financeiro</div>
    </div>
    <div class="submenu">
      <div class="subitem" onclick="loadAndClose('caixa.html')">Caixa</div>
      <div class="subitem" onclick="loadAndClose('despesas.html')">Despesas</div>
    </div>

    <div class="item" onclick="loadPage('configuracoes.html',this)">
      <div class="icon">‚öôÔ∏è</div>
      <div class="label">Configura√ß√µes</div>
    </div>

  </div>

  <div class="sidebar-footer">
    <div class="logout" onclick="logout()">
      <div class="icon">üö™</div>
      <span>Sair</span>
    </div>
  </div>
</div>

<!-- MAIN -->
<div class="main">
  <div class="topbar">
    <div class="toggle" onclick="toggleSidebar()">‚ò∞</div>
    <div class="user" id="userName">Carregando...</div>
  </div>

  <div class="content">
    <iframe id="frame" src="home.html"></iframe>
  </div>
</div>

<script>
const supabase = supabase.createClient(
  "https://ssmsjryjwhnrbjyzklno.supabase.co",
  "sb_publishable_5Xe5sBRsp-6aLLvMwiTsCA_vRcPpNnV"
);

const sidebar = document.getElementById("sidebar");
const frame = document.getElementById("frame");

/* üîê PROTE√á√ÉO */
(async ()=>{
  const { data:{ user } } = await supabase.auth.getUser();
  if(!user){
    window.location.href="index.html";
    return;
  }
  document.getElementById("userName").innerText = user.email;
})();

/* MENU */
function toggleSidebar(){
  sidebar.classList.toggle("collapsed");
}

/* SUBMENU */
function toggleSub(el){
  const sub = el.nextElementSibling;
  document.querySelectorAll(".submenu").forEach(s=>{
    if(s!==sub) s.style.display="none";
  });
  sub.style.display = sub.style.display==="flex" ? "none" : "flex";
}

/* LOAD */
function loadPage(page,el){
  frame.src = page;
  document.querySelectorAll(".item").forEach(i=>i.classList.remove("active"));
  if(el) el.classList.add("active");
}

/* LOAD + FECHA */
function loadAndClose(page){
  frame.src = page;
  document.querySelectorAll(".submenu").forEach(s=>s.style.display="none");
  sidebar.classList.add("collapsed");
}

/* LOGOUT */
async function logout(){
  await supabase.auth.signOut();
  window.location.href="index.html";
}
</script>

</body>
</html>
